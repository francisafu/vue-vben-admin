var M=Object.defineProperty,O=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var P=(a,e,o)=>e in a?M(a,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[e]=o,E=(a,e)=>{for(var o in e||(e={}))C.call(e,o)&&P(a,o,e[o]);if(w)for(var o of w(e))D.call(e,o)&&P(a,o,e[o]);return a},S=(a,e)=>O(a,V(e));var l=(a,e,o)=>new Promise((f,I)=>{var m=s=>{try{r(o.next(s))}catch(u){I(u)}},d=s=>{try{r(o.throw(s))}catch(u){I(u)}},r=s=>s.done?f(s.value):Promise.resolve(s.value).then(m,d);r((o=o.apply(a,e)).next())});import{u as F}from"./form-B-jfQdK6.js";import{s as A,$ as t,ag as N,a6 as U,a0 as p,q as j}from"./bootstrap-nS_r6Uzy.js";import{d as R,r as y,c as v,E as z,k as _,K,m as x,j as $,x as T,u as h,b as G}from"../jse/index-index-BsdptGcH.js";import{u as H}from"./use-modal-qTZq-J3o.js";function se(a){return l(this,null,function*(){return A.post("/accountinfos/list",a)})}function J(a){return l(this,null,function*(){return A.post("/accountinfos/create",a)})}function L(a,e){return l(this,null,function*(){return A.post(`/accountinfos/${a}/update`,e)})}function re(a){return l(this,null,function*(){return A.post(`/accountinfos/${a}/delete`)})}const Q={class:"account-info-modal p-4"},W={key:0,class:"flex-center py-10"},X={class:"text-center"},Y={key:1},Z=R({__name:"account-info-modal",setup(a){const e=y({}),o=v(()=>{var n;return(n=e.value)==null?void 0:n.isEdit}),f=v(()=>{var n;return(n=e.value)==null?void 0:n.accountInfoData}),I=v(()=>{var n;return(n=e.value)==null?void 0:n.activityId}),m=y(!1),d=y(!1),r=y([]),[s,u]=F({layout:"vertical",handleSubmit:B,submitButtonOptions:v(()=>({content:t("page.common.save"),disabled:d.value,loading:d.value})),resetButtonOptions:v(()=>({content:t("page.common.clear"),disabled:d.value})),commonConfig:{componentProps:{class:"w-full"}},schema:[{component:"Input",componentProps:{placeholder:t("page.accountInfo.accountPlaceholder")},fieldName:"account",label:t("page.accountInfo.account"),rules:"required"},{component:"Input",componentProps:{placeholder:t("page.accountInfo.passwordPlaceholder"),type:"password"},fieldName:"password",label:t("page.accountInfo.password"),rules:"required"},{component:"Select",componentProps:{placeholder:t("page.accountInfo.addressPlaceholder"),options:r},fieldName:"addressId",label:t("page.accountInfo.address"),rules:"required"}]}),[k,b]=H({title:t("page.accountInfo.accountInfoManagement"),draggable:!0,footer:!1,onOpenChange(n){return l(this,null,function*(){var c;if(n)if(e.value=b.getData()||{},yield q(),u.resetFields&&u.resetFields(),o.value&&f.value){const i=f.value;u.setValues({account:i.account,password:i.password,addressId:(c=i.address)==null?void 0:c.id})}else u.setValues({account:"",password:"",addressId:void 0})})}});function q(){return l(this,null,function*(){try{m.value=!0;const c=(yield N()).id;if(!c||typeof c!="number")throw new Error(t("page.accountInfo.invalidUserId"));const i=yield U(c);r.value=i.map(g=>({label:`${g.name} ${g.phone} ${g.fullAddress}`,value:g.id})),i.length===0&&(r.value=[{label:t("page.accountInfo.addAddressInProfile"),value:0,disabled:!0}])}catch(n){p.error(t("page.accountInfo.fetchUserAddressError")),r.value=[{label:t("page.accountInfo.fetchAddressRetry"),value:0,disabled:!0}]}finally{m.value=!1}})}function B(n){return l(this,null,function*(){try{if(d.value=!0,!I.value){p.error(t("page.accountInfo.activityIdRequired"));return}const c=S(E({},n),{activityId:I.value});o.value?(yield L(f.value.id,{account:n.account,password:n.password,addressId:n.addressId}),p.success(t("page.accountInfo.updateAccountInfoSuccess"))):(yield J(c),p.success(t("page.accountInfo.addAccountInfoSuccess"))),e.value.operationSuccess=!0,b.close()}catch(c){o.value?p.error(t("page.accountInfo.updateAccountInfoError")):p.error(t("page.accountInfo.addAccountInfoError"))}finally{d.value=!1}})}return(n,c)=>(_(),z(h(k),null,{default:K(()=>[x("div",Q,[m.value?(_(),$("div",W,[x("div",X,T(h(t)("page.common.loading")),1)])):(_(),$("div",Y,[G(h(s))]))])]),_:1}))}}),ee=j(Z,[["__scopeId","data-v-ed431983"]]),ue=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{ee as A,ue as a,re as d,se as l};

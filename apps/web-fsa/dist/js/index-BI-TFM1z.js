var Q=Object.defineProperty,Z=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var D=(u,n,r)=>n in u?Q(u,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[n]=r,P=(u,n)=>{for(var r in n||(n={}))H.call(n,r)&&D(u,r,n[r]);if(z)for(var r of z(n))J.call(n,r)&&D(u,r,n[r]);return u},M=(u,n)=>Z(u,G(n));var _=(u,n,r)=>new Promise((d,h)=>{var w=c=>{try{C(r.next(c))}catch(E){h(E)}},f=c=>{try{C(r.throw(c))}catch(E){h(E)}},C=c=>c.done?d(c.value):Promise.resolve(c.value).then(w,f);C((r=r.apply(u,n)).next())});import{$ as e,Z as k,a4 as X,a0 as v,a5 as Y,a3 as ee,a6 as ae,q as te}from"./bootstrap-nS_r6Uzy.js";import se from"./user-modal-lFFsVp3K.js";import{C as V,T as I}from"./index-CcPG30jJ.js";import re from"./index-CGfLNaW6.js";import b from"./index-BpouPXFr.js";import{_ as oe}from"./page.vue_vue_type_script_setup_true_lang-7X23zIuy.js";import{d as le,r as S,Q as ie,D as ne,f as de,E as pe,k as U,K as o,b as l,m as p,u as t,x as i,L as g,j as R,l as N,F as ue}from"../jse/index-index-BsdptGcH.js";import{u as ce}from"./use-modal-qTZq-J3o.js";import"./form-B-jfQdK6.js";import"./use-vben-form-qIoZL4uF.js";import"./index-BMGsZtLz.js";import"./checkbox.vue_vue_type_script_setup_true_lang-BsbbvZXe.js";import"./render-content.vue_vue_type_script_lang-0IkNOgdT.js";import"./index-nI7GpMDK.js";import"./shallowequal-BMhVrTHr.js";import"./Trigger-DmB6V4sb.js";import"./ResizeObserver.es-CDE7jhPe.js";import"./_arrayIncludes-B8uzE354.js";import"./Overflow-CQR0eu18.js";import"./BaseInput-CIdroiOM.js";import"./index-Br3j_qDQ.js";import"./colors-D59xGIwT.js";import"./roundedArrow-EYTrNAJt.js";import"./collapseMotion-C22yorKZ.js";import"./slide-B2l4e1mx.js";import"./useRefs-Bl8svD-7.js";import"./responsiveObserve-7YYVRPOL.js";import"./DownOutlined-Cy6ShKlK.js";import"./useMergedState-DdQG7FS2.js";import"./EyeOutlined-BiKHx9cD.js";import"./index-BXkl_ASy.js";import"./index-DZFK9PNa.js";import"./CheckOutlined-zUdIMjW3.js";import"./SearchOutlined-8BTzpijE.js";import"./move-k9NGEOQn.js";import"./index-DhGJMtpN.js";import"./index-BGX4ANgK.js";import"./index-DFgcUpmS.js";import"./index-Bbbh6CzF.js";import"./Checkbox-BijoKviF.js";import"./FormItemContext-CbGyyj-A.js";import"./index-CBzSDfyB.js";import"./statusUtils-DG2SPV6v.js";import"./x-BlW8OOV2.js";const me={class:"p-4"},ge={class:"mb-4 text-2xl font-bold"},fe={class:"flex flex-wrap items-center gap-4"},he={class:"flex items-center"},ve={class:"mr-2"},ye={class:"flex items-center"},_e={class:"mr-2"},ke={class:"flex items-center"},be={class:"mr-2"},xe={class:"flex items-center ml-4"},we={style:{width:"100%",height:"880px"}},Ce={class:"px-4"},Ee={class:"mb-2 font-medium"},Se={key:0,class:"py-4 text-center text-gray-500"},Ue=le({__name:"index",setup(u){const n=S([]),r=S(!1),d=ie({current:1,pageSize:10,total:0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:a=>`${e("page.common.total")} ${a} ${e("page.common.items")}`}),h=S({}),w=S({}),f=S({page:1,pageSize:10,keyword:"",role:void 0,isEnabled:void 0}),[C,c]=ce({connectedComponent:se,onOpenChange:a=>_(null,null,function*(){if(!a){const s=c.getData();s&&s.operationSuccess&&(yield y())}})});function E(a){return _(this,null,function*(){try{r.value=!0;const s={isEnabled:!a.isEnabled};yield X(a.id,s),a.isEnabled?v.success(e("page.user.disableUserSuccess")):v.success(e("page.user.enableUserSuccess")),yield y()}catch(s){a.isEnabled?v.error(e("page.user.disableUserError")):v.error(e("page.user.enableUserError"))}finally{r.value=!1}})}function O(a){return _(this,null,function*(){if(!h.value[a])try{w.value[a]=!0;const s=yield ae(a);h.value[a]=s}catch(s){v.error(e("page.user.fetchAddressError")),h.value[a]=[]}finally{w.value[a]=!1}})}const T=[{title:e("page.common.seqNo"),key:"seq",width:60,customRender:({index:a})=>(d.current-1)*d.pageSize+a+1},{title:e("page.user.username"),dataIndex:"username",key:"username",minWidth:120},{title:e("page.user.phone"),dataIndex:"phone",key:"phone",minWidth:120},{title:e("page.user.role"),dataIndex:"role",key:"role",minWidth:120,customRender:({text:a})=>({ADMIN:e("page.user.roleAdmin"),VIP:e("page.user.roleVip"),USER:e("page.user.roleUser")})[a]||a},{title:e("page.user.status"),dataIndex:"isEnabled",key:"isEnabled",minWidth:100,customRender:({record:a})=>{const s=a.isEnabled;return ne(k,{type:s?"primary":"default",danger:!s,size:"small",onClick:()=>E(a),style:s?{backgroundColor:"#52c41a",borderColor:"#52c41a"}:{}},()=>s?e("page.user.statusEnabled"):e("page.user.statusDisabled"))}},{title:e("page.common.action"),key:"action",minWidth:180}],L=[{title:e("page.user.address.name"),dataIndex:"name",key:"name",width:120},{title:e("page.user.address.phone"),dataIndex:"phone",key:"phone",width:120},{title:e("page.user.address.fullAddress"),dataIndex:"fullAddress",key:"fullAddress",minWidth:200}];function W(){c.setState({title:e("page.user.addUser")}).setData({userData:null,isEdit:!1}).open()}function $(a){c.setState({title:e("page.user.editUser")}).setData({userData:a,isEdit:!0}).open()}function B(a){c.setState({title:e("page.user.changePassword")}).setData({userData:a,isPasswordMode:!0}).open()}function q(a){return _(this,null,function*(){try{r.value=!0,yield Y(a.id),v.success(e("page.user.deleteUserSuccess")),yield y()}catch(s){v.error(e("page.user.deleteUserError"))}finally{r.value=!1}})}function y(){return _(this,null,function*(){try{r.value=!0;const a=yield ee(M(P({},f.value),{page:d.current||1,pageSize:d.pageSize||10}));n.value=a.list,d.current=a.pagination.current,d.pageSize=a.pagination.pageSize,d.total=a.pagination.total}catch(a){v.error(e("page.user.fetchUserListError"))}finally{r.value=!1}})}function K(a){d.current=a.current,d.pageSize=a.pageSize,y()}function F(a,s){a&&O(s.id)}function A(){d.current=1,y()}function j(){f.value={page:1,pageSize:10,keyword:"",role:void 0,isEnabled:void 0},d.current=1,y()}return de(()=>_(null,null,function*(){yield y()})),(a,s)=>(U(),pe(t(oe),null,{default:o(()=>[l(t(C)),p("div",me,[p("h1",ge,i(t(e)("page.user.title")),1),l(t(V),{bordered:!1,class:"mb-4"},{default:o(()=>[p("div",fe,[p("div",he,[p("span",ve,i(t(e)("page.user.keyword")),1),l(t(re),{value:f.value.keyword,"onUpdate:value":s[0]||(s[0]=m=>f.value.keyword=m),placeholder:t(e)("page.user.keywordPlaceholder"),style:{width:"200px"},onPressEnter:A},null,8,["value","placeholder"])]),p("div",ye,[p("span",_e,i(t(e)("page.user.role")),1),l(t(b),{value:f.value.role,"onUpdate:value":s[1]||(s[1]=m=>f.value.role=m),placeholder:t(e)("page.user.rolePlaceholder"),style:{width:"120px"},allowClear:""},{default:o(()=>[l(t(b).Option,{value:"ADMIN"},{default:o(()=>[g(i(t(e)("page.user.roleAdmin")),1)]),_:1}),l(t(b).Option,{value:"VIP"},{default:o(()=>[g(i(t(e)("page.user.roleVip")),1)]),_:1}),l(t(b).Option,{value:"USER"},{default:o(()=>[g(i(t(e)("page.user.roleUser")),1)]),_:1})]),_:1},8,["value","placeholder"])]),p("div",ke,[p("span",be,i(t(e)("page.user.status")),1),l(t(b),{value:f.value.isEnabled,"onUpdate:value":s[2]||(s[2]=m=>f.value.isEnabled=m),placeholder:t(e)("page.user.statusPlaceholder"),style:{width:"120px"},allowClear:""},{default:o(()=>[l(t(b).Option,{value:"true"},{default:o(()=>[g(i(t(e)("page.user.statusEnabled")),1)]),_:1}),l(t(b).Option,{value:"false"},{default:o(()=>[g(i(t(e)("page.user.statusDisabled")),1)]),_:1})]),_:1},8,["value","placeholder"])]),p("div",xe,[l(t(k),{type:"primary",onClick:A,class:"mr-2"},{default:o(()=>[g(i(t(e)("page.common.search")),1)]),_:1}),l(t(k),{onClick:j},{default:o(()=>[g(i(t(e)("page.common.clear")),1)]),_:1})])])]),_:1}),l(t(V),{bordered:!1},{extra:o(()=>[l(t(k),{type:"primary",onClick:W},{default:o(()=>[g(i(t(e)("page.user.addUser")),1)]),_:1})]),default:o(()=>[p("div",we,[l(t(I),{columns:T,dataSource:n.value,pagination:d,loading:r.value,rowKey:"id",scroll:{y:750},onChange:K,onExpand:F},{expandColumnTitle:o(()=>[p("span",null,i(t(e)("page.user.address.title")),1)]),expandedRowRender:o(({record:m})=>{var x;return[p("div",Ce,[p("div",Ee,i(t(e)("page.user.addressList")),1),l(t(I),{columns:L,dataSource:h.value[m.id]||[],loading:w.value[m.id],pagination:!1,size:"small",rowKey:"id",bordered:""},null,8,["dataSource","loading"]),((x=h.value[m.id])==null?void 0:x.length)===0?(U(),R("div",Se,i(t(e)("page.user.noAddress")),1)):N("",!0)])]}),bodyCell:o(({column:m,record:x})=>[m.key==="action"?(U(),R(ue,{key:0},[l(t(k),{type:"link",onClick:()=>$(x)},{default:o(()=>[g(i(t(e)("page.common.edit")),1)]),_:2},1032,["onClick"]),l(t(k),{type:"link",style:{color:"#faad14"},onClick:()=>B(x)},{default:o(()=>[g(i(t(e)("page.user.changePassword")),1)]),_:2},1032,["onClick"]),l(t(k),{type:"link",danger:"",onClick:()=>q(x)},{default:o(()=>[g(i(t(e)("page.common.delete")),1)]),_:2},1032,["onClick"])],64)):N("",!0)]),_:1},8,["dataSource","pagination","loading"])])]),_:1})])]),_:1}))}}),_a=te(Ue,[["__scopeId","data-v-1439ecbe"]]);export{_a as default};

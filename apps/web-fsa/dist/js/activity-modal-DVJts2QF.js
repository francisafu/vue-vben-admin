var L=Object.defineProperty,w=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var h=(o,e,a)=>e in o?L(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a,A=(o,e)=>{for(var a in e||(e={}))O.call(e,a)&&h(o,a,e[a]);if(_)for(var a of _(e))S.call(e,a)&&h(o,a,e[a]);return o},E=(o,e)=>w(o,C(e));var f=(o,e,a)=>new Promise((l,p)=>{var c=s=>{try{n(a.next(s))}catch(m){p(m)}},v=s=>{try{n(a.throw(s))}catch(m){p(m)}},n=s=>s.done?l(s.value):Promise.resolve(s.value).then(c,v);n((a=a.apply(o,e)).next())});import{u as k}from"./form-Dc7pQKZ8.js";import{b1 as t,bL as d,bs as x}from"./bootstrap-BJQ4xY_l.js";import{u as N,c as V}from"./activity-dN6_do1T.js";import{a4 as B,P as y,J as u,a_ as Y,aa as F,ab as g,ac as R,aD as D,av as H,aj as q,a7 as b,x as I}from"../jse/index-index-CZjfKQLv.js";import{u as j}from"./use-modal-DAPfi6Bw.js";import"./use-vben-form-9RyIkVnb.js";import"./index-vlz9cqoy.js";import"./checkbox.vue_vue_type_script_setup_true_lang-obtDsCTt.js";import"./render-content.vue_vue_type_script_lang-DyZFyp8x.js";import"./x-BkBkBKrZ.js";const J={class:"activity-modal p-4"},$={key:0,class:"flex-center py-10"},z={class:"text-center"},G={key:1},K=B({__name:"activity-modal",setup(o){const e=y({}),a=u(()=>{var i;return(i=e.value)==null?void 0:i.isEdit}),l=u(()=>{var i;return(i=e.value)==null?void 0:i.activityData}),p=y(!1),c=y(!1),v=[{component:"Select",componentProps:{placeholder:t("page.activity.brandPlaceholder"),options:[{label:t("page.activity.brandLOREAL"),value:"LOREAL"},{label:t("page.activity.brandESTEE"),value:"ESTEE"},{label:t("page.activity.brandLOCCITANE"),value:"LOCCITANE"}]},fieldName:"brand",label:t("page.activity.brand"),rules:"required"},{component:"DatePicker",componentProps:{placeholder:t("page.activity.startTimePlaceholder"),showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",style:{width:"100%"}},fieldName:"startTime",label:t("page.activity.startTime"),rules:"required"},{component:"DatePicker",componentProps:{placeholder:t("page.activity.endTimePlaceholder"),showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",style:{width:"100%"}},fieldName:"endTime",label:t("page.activity.endTime"),rules:"required"}],[n,s]=k({layout:"vertical",handleSubmit:P,submitButtonOptions:u(()=>({content:t("page.common.save"),disabled:c.value,loading:c.value})),resetButtonOptions:u(()=>({content:t("page.common.clear"),disabled:c.value})),commonConfig:{componentProps:{class:"w-full"}},schema:v}),[m,T]=j({title:t("page.activity.activityManagement"),draggable:!0,footer:!1,onOpenChange(i){return f(this,null,function*(){if(i)if(e.value=T.getData()||{},s.resetFields&&s.resetFields(),a.value&&l.value){const r=l.value;s.setValues({brand:r.brand,startTime:Y(r.startTime),endTime:Y(r.endTime)})}else s.setValues({brand:"LOREAL",startTime:null,endTime:null})})}});function M(i,r){return!i||!r?!1:r.isAfter(i)}function P(i){return f(this,null,function*(){try{if(c.value=!0,!M(i.startTime,i.endTime)){d.error(t("page.activity.timeRangeError")),c.value=!1;return}const r=E(A({},i),{startTime:i.startTime.format("YYYY-MM-DD HH:mm:00"),endTime:i.endTime.format("YYYY-MM-DD HH:mm:00")});a.value?(yield N(l.value.id,r),d.success(t("page.activity.updateActivitySuccess"))):(yield V(r),d.success(t("page.activity.addActivitySuccess"))),e.value.operationSuccess=!0,T.close()}catch(r){a.value?d.error(t("page.activity.updateActivityError")):d.error(t("page.activity.addActivityError"))}finally{c.value=!1}})}return(i,r)=>(g(),F(b(m),null,{default:R(()=>[D("div",J,[p.value?(g(),H("div",$,[D("div",z,q(b(t)("page.common.loading")),1)])):(g(),H("div",G,[I(b(n))]))])]),_:1}))}}),re=x(K,[["__scopeId","data-v-b3c1cd7a"]]);export{re as default};

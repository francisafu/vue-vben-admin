var G=Object.defineProperty,H=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var D=(u,n,r)=>n in u?G(u,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[n]=r,P=(u,n)=>{for(var r in n||(n={}))Q.call(n,r)&&D(u,r,n[r]);if(z)for(var r of z(n))X.call(n,r)&&D(u,r,n[r]);return u},M=(u,n)=>H(u,J(n));var _=(u,n,r)=>new Promise((d,h)=>{var w=c=>{try{C(r.next(c))}catch(S){h(S)}},f=c=>{try{C(r.throw(c))}catch(S){h(S)}},C=c=>c.done?d(c.value):Promise.resolve(c.value).then(w,f);C((r=r.apply(u,n)).next())});import{b1 as e,as as b,cm as Y,bL as v,cn as Z,ch as ee,bT as ae,bs as te}from"./bootstrap-BJQ4xY_l.js";import se from"./user-modal-CxJ_Cwwl.js";import{C as R}from"./index-BQkm4ls3.js";import re from"./index-DLmHigjb.js";import k from"./index-BM9rJksX.js";import{_ as oe}from"./page.vue_vue_type_script_setup_true_lang-B9bC9-VS.js";import{a4 as le,P as E,R as ie,k as ne,a9 as de,aa as pe,ab as U,ac as o,x as l,aD as p,a7 as t,aj as i,ai as g,av as V,aq as I,F as ue}from"../jse/index-index-CZjfKQLv.js";import{u as ce}from"./use-modal-DAPfi6Bw.js";import{T}from"./index-DLMgysYk.js";import"./form-Dc7pQKZ8.js";import"./use-vben-form-9RyIkVnb.js";import"./index-vlz9cqoy.js";import"./checkbox.vue_vue_type_script_setup_true_lang-obtDsCTt.js";import"./render-content.vue_vue_type_script_lang-DyZFyp8x.js";import"./index-DxP7Q5m2.js";import"./shallowequal-DAHsgHgw.js";import"./Trigger-5OmG7_kU.js";import"./vnode-D8jwJZNd.js";import"./ResizeObserver.es-CDE7jhPe.js";import"./_arrayIncludes-B8uzE354.js";import"./Overflow-yCxUNdPh.js";import"./index-BGjYeiJD.js";import"./index-DvMZm7Iy.js";import"./colors--zQ5faGU.js";import"./roundedArrow-EYTrNAJt.js";import"./collapseMotion-BT6S83uu.js";import"./slide-Ck_Vj4NP.js";import"./Dropdown-Bp5cfo1-.js";import"./useRefs-bVNVOK4Y.js";import"./hasIn-lNdCFDV4.js";import"./isSymbol-C31Rw1Kw.js";import"./isMobile-8sZ0LT6r.js";import"./useMergedState-Bh_I602w.js";import"./isPlainObject-B1TclPtS.js";import"./FormItemContext-2Feh-36j.js";import"./statusUtils-BafBw23h.js";import"./BaseInput-Rv6b8NC9.js";import"./index-BuC4_ePy.js";import"./SearchOutlined-9BLVvX1_.js";import"./EyeOutlined-DUjoKg0O.js";import"./index-BeMQm5ge.js";import"./DownOutlined-DSHotxfp.js";import"./CheckOutlined-vre5dF4J.js";import"./move-BvB2OTP0.js";import"./x-BkBkBKrZ.js";import"./index-C2Zr63jJ.js";import"./index-DXwAwwq7.js";import"./index-CUBibixF.js";import"./responsiveObserve-DoomOr37.js";import"./index-2uLRgq7k.js";import"./Checkbox-DiA9qKvl.js";import"./index-CGIEbGbJ.js";const me={class:"p-4"},ge={class:"mb-4 text-2xl font-bold"},fe={class:"flex flex-wrap items-center gap-4"},he={class:"flex items-center"},ve={class:"mr-2"},ye={class:"flex items-center"},_e={class:"mr-2"},be={class:"flex items-center"},ke={class:"mr-2"},xe={class:"flex items-center ml-4"},we={style:{width:"100%",height:"880px"}},Ce={class:"px-4"},Se={class:"mb-2 font-medium"},Ee={key:0,class:"py-4 text-center text-gray-500"},Ue=le({__name:"index",setup(u){const n=E([]),r=E(!1),d=ie({current:1,pageSize:10,total:0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:a=>`${e("page.common.total")} ${a} ${e("page.common.items")}`}),h=E({}),w=E({}),f=E({page:1,pageSize:10,keyword:"",role:void 0,isEnabled:void 0}),[C,c]=ce({connectedComponent:se,onOpenChange:a=>_(null,null,function*(){if(!a){const s=c.getData();s&&s.operationSuccess&&(yield y())}})});function S(a){return _(this,null,function*(){try{r.value=!0;const s={isEnabled:!a.isEnabled};yield Y(a.id,s),a.isEnabled?v.success(e("page.user.disableUserSuccess")):v.success(e("page.user.enableUserSuccess")),yield y()}catch(s){a.isEnabled?v.error(e("page.user.disableUserError")):v.error(e("page.user.enableUserError"))}finally{r.value=!1}})}function N(a){return _(this,null,function*(){if(!h.value[a])try{w.value[a]=!0;const s=yield ae(a);h.value[a]=s}catch(s){v.error(e("page.user.fetchAddressError")),h.value[a]=[]}finally{w.value[a]=!1}})}const O=[{title:e("page.common.seqNo"),key:"seq",width:60,customRender:({index:a})=>(d.current-1)*d.pageSize+a+1},{title:e("page.user.username"),dataIndex:"username",key:"username",minWidth:120},{title:e("page.user.phone"),dataIndex:"phone",key:"phone",minWidth:120},{title:e("page.user.role"),dataIndex:"role",key:"role",minWidth:120,customRender:({text:a})=>({ADMIN:e("page.user.roleAdmin"),VIP:e("page.user.roleVip"),USER:e("page.user.roleUser")})[a]||a},{title:e("page.user.status"),dataIndex:"isEnabled",key:"isEnabled",minWidth:100,customRender:({record:a})=>{const s=a.isEnabled;return ne(b,{type:s?"primary":"default",danger:!s,size:"small",onClick:()=>S(a),style:s?{backgroundColor:"#52c41a",borderColor:"#52c41a"}:{}},()=>s?e("page.user.statusEnabled"):e("page.user.statusDisabled"))}},{title:e("page.common.action"),key:"action",minWidth:180}],L=[{title:e("page.user.address.name"),dataIndex:"name",key:"name",width:120},{title:e("page.user.address.phone"),dataIndex:"phone",key:"phone",width:120},{title:e("page.user.address.fullAddress"),dataIndex:"fullAddress",key:"fullAddress",minWidth:200}];function W(){c.setState({title:e("page.user.addUser")}).setData({userData:null,isEdit:!1}).open()}function B(a){c.setState({title:e("page.user.editUser")}).setData({userData:a,isEdit:!0}).open()}function $(a){c.setState({title:e("page.user.changePassword")}).setData({userData:a,isPasswordMode:!0}).open()}function q(a){return _(this,null,function*(){try{r.value=!0,yield Z(a.id),v.success(e("page.user.deleteUserSuccess")),yield y()}catch(s){v.error(e("page.user.deleteUserError"))}finally{r.value=!1}})}function y(){return _(this,null,function*(){try{r.value=!0;const a=yield ee(M(P({},f.value),{page:d.current||1,pageSize:d.pageSize||10}));n.value=a.list,d.current=a.pagination.current,d.pageSize=a.pagination.pageSize,d.total=a.pagination.total}catch(a){v.error(e("page.user.fetchUserListError"))}finally{r.value=!1}})}function F(a){d.current=a.current,d.pageSize=a.pageSize,y()}function K(a,s){a&&N(s.id)}function A(){d.current=1,y()}function j(){f.value={page:1,pageSize:10,keyword:"",role:void 0,isEnabled:void 0},d.current=1,y()}return de(()=>_(null,null,function*(){yield y()})),(a,s)=>(U(),pe(t(oe),null,{default:o(()=>[l(t(C)),p("div",me,[p("h1",ge,i(t(e)("page.user.title")),1),l(t(R),{bordered:!1,class:"mb-4"},{default:o(()=>[p("div",fe,[p("div",he,[p("span",ve,i(t(e)("page.user.keyword")),1),l(t(re),{value:f.value.keyword,"onUpdate:value":s[0]||(s[0]=m=>f.value.keyword=m),placeholder:t(e)("page.user.keywordPlaceholder"),style:{width:"200px"},onPressEnter:A},null,8,["value","placeholder"])]),p("div",ye,[p("span",_e,i(t(e)("page.user.role")),1),l(t(k),{value:f.value.role,"onUpdate:value":s[1]||(s[1]=m=>f.value.role=m),placeholder:t(e)("page.user.rolePlaceholder"),style:{width:"120px"},allowClear:""},{default:o(()=>[l(t(k).Option,{value:"ADMIN"},{default:o(()=>[g(i(t(e)("page.user.roleAdmin")),1)]),_:1}),l(t(k).Option,{value:"VIP"},{default:o(()=>[g(i(t(e)("page.user.roleVip")),1)]),_:1}),l(t(k).Option,{value:"USER"},{default:o(()=>[g(i(t(e)("page.user.roleUser")),1)]),_:1})]),_:1},8,["value","placeholder"])]),p("div",be,[p("span",ke,i(t(e)("page.user.status")),1),l(t(k),{value:f.value.isEnabled,"onUpdate:value":s[2]||(s[2]=m=>f.value.isEnabled=m),placeholder:t(e)("page.user.statusPlaceholder"),style:{width:"120px"},allowClear:""},{default:o(()=>[l(t(k).Option,{value:"true"},{default:o(()=>[g(i(t(e)("page.user.statusEnabled")),1)]),_:1}),l(t(k).Option,{value:"false"},{default:o(()=>[g(i(t(e)("page.user.statusDisabled")),1)]),_:1})]),_:1},8,["value","placeholder"])]),p("div",xe,[l(t(b),{type:"primary",onClick:A,class:"mr-2"},{default:o(()=>[g(i(t(e)("page.common.search")),1)]),_:1}),l(t(b),{onClick:j},{default:o(()=>[g(i(t(e)("page.common.clear")),1)]),_:1})])])]),_:1}),l(t(R),{bordered:!1},{extra:o(()=>[l(t(b),{type:"primary",onClick:W},{default:o(()=>[g(i(t(e)("page.user.addUser")),1)]),_:1})]),default:o(()=>[p("div",we,[l(t(T),{columns:O,dataSource:n.value,pagination:d,loading:r.value,rowKey:"id",scroll:{y:750},onChange:F,onExpand:K},{expandColumnTitle:o(()=>[p("span",null,i(t(e)("page.user.address.title")),1)]),expandedRowRender:o(({record:m})=>{var x;return[p("div",Ce,[p("div",Se,i(t(e)("page.user.addressList")),1),l(t(T),{columns:L,dataSource:h.value[m.id]||[],loading:w.value[m.id],pagination:!1,size:"small",rowKey:"id",bordered:""},null,8,["dataSource","loading"]),((x=h.value[m.id])==null?void 0:x.length)===0?(U(),V("div",Ee,i(t(e)("page.user.noAddress")),1)):I("",!0)])]}),bodyCell:o(({column:m,record:x})=>[m.key==="action"?(U(),V(ue,{key:0},[l(t(b),{type:"link",onClick:()=>B(x)},{default:o(()=>[g(i(t(e)("page.common.edit")),1)]),_:2},1032,["onClick"]),l(t(b),{type:"link",style:{color:"#faad14"},onClick:()=>$(x)},{default:o(()=>[g(i(t(e)("page.user.changePassword")),1)]),_:2},1032,["onClick"]),l(t(b),{type:"link",danger:"",onClick:()=>q(x)},{default:o(()=>[g(i(t(e)("page.common.delete")),1)]),_:2},1032,["onClick"])],64)):I("",!0)]),_:1},8,["dataSource","pagination","loading"])])]),_:1})])]),_:1}))}}),Ua=te(Ue,[["__scopeId","data-v-1439ecbe"]]);export{Ua as default};

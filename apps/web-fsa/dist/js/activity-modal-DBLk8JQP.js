var k=Object.defineProperty,w=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var h=(o,e,t)=>e in o?k(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,A=(o,e)=>{for(var t in e||(e={}))L.call(e,t)&&h(o,t,e[t]);if(_)for(var t of _(e))O.call(e,t)&&h(o,t,e[t]);return o},E=(o,e)=>w(o,C(e));var f=(o,e,t)=>new Promise((l,p)=>{var c=r=>{try{n(t.next(r))}catch(m){p(m)}},v=r=>{try{n(t.throw(r))}catch(m){p(m)}},n=r=>r.done?l(r.value):Promise.resolve(r.value).then(c,v);n((t=t.apply(o,e)).next())});import{u as S}from"./form-B-jfQdK6.js";import{$ as a,a0 as d,q as V}from"./bootstrap-nS_r6Uzy.js";import{u as x,c as N}from"./activity-DE1i53PR.js";import{d as B,r as y,c as u,V as Y,E as F,k as g,K as R,m as D,j as H,x as q,u as b,b as I}from"../jse/index-index-BsdptGcH.js";import{u as j}from"./use-modal-qTZq-J3o.js";import"./use-vben-form-qIoZL4uF.js";import"./index-BMGsZtLz.js";import"./checkbox.vue_vue_type_script_setup_true_lang-BsbbvZXe.js";import"./render-content.vue_vue_type_script_lang-0IkNOgdT.js";import"./x-BlW8OOV2.js";const $={class:"activity-modal p-4"},K={key:0,class:"flex-center py-10"},z={class:"text-center"},G={key:1},J=B({__name:"activity-modal",setup(o){const e=y({}),t=u(()=>{var i;return(i=e.value)==null?void 0:i.isEdit}),l=u(()=>{var i;return(i=e.value)==null?void 0:i.activityData}),p=y(!1),c=y(!1),v=[{component:"Select",componentProps:{placeholder:a("page.activity.brandPlaceholder"),options:[{label:a("page.activity.brandLOREAL"),value:"LOREAL"},{label:a("page.activity.brandESTEE"),value:"ESTEE"},{label:a("page.activity.brandLOCCITANE"),value:"LOCCITANE"}]},fieldName:"brand",label:a("page.activity.brand"),rules:"required"},{component:"DatePicker",componentProps:{placeholder:a("page.activity.startTimePlaceholder"),showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",style:{width:"100%"}},fieldName:"startTime",label:a("page.activity.startTime"),rules:"required"},{component:"DatePicker",componentProps:{placeholder:a("page.activity.endTimePlaceholder"),showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",style:{width:"100%"}},fieldName:"endTime",label:a("page.activity.endTime"),rules:"required"}],[n,r]=S({layout:"vertical",handleSubmit:P,submitButtonOptions:u(()=>({content:a("page.common.save"),disabled:c.value,loading:c.value})),resetButtonOptions:u(()=>({content:a("page.common.clear"),disabled:c.value})),commonConfig:{componentProps:{class:"w-full"}},schema:v}),[m,T]=j({title:a("page.activity.activityManagement"),draggable:!0,footer:!1,onOpenChange(i){return f(this,null,function*(){if(i)if(e.value=T.getData()||{},r.resetFields&&r.resetFields(),t.value&&l.value){const s=l.value;r.setValues({brand:s.brand,startTime:Y(s.startTime),endTime:Y(s.endTime)})}else r.setValues({brand:"LOREAL",startTime:null,endTime:null})})}});function M(i,s){return!i||!s?!1:s.isAfter(i)}function P(i){return f(this,null,function*(){try{if(c.value=!0,!M(i.startTime,i.endTime)){d.error(a("page.activity.timeRangeError")),c.value=!1;return}const s=E(A({},i),{startTime:i.startTime.format("YYYY-MM-DD HH:mm:00"),endTime:i.endTime.format("YYYY-MM-DD HH:mm:00")});t.value?(yield x(l.value.id,s),d.success(a("page.activity.updateActivitySuccess"))):(yield N(s),d.success(a("page.activity.addActivitySuccess"))),e.value.operationSuccess=!0,T.close()}catch(s){t.value?d.error(a("page.activity.updateActivityError")):d.error(a("page.activity.addActivityError"))}finally{c.value=!1}})}return(i,s)=>(g(),F(b(m),null,{default:R(()=>[D("div",$,[p.value?(g(),H("div",K,[D("div",z,q(b(a)("page.common.loading")),1)])):(g(),H("div",G,[I(b(n))]))])]),_:1}))}}),se=V(J,[["__scopeId","data-v-b3c1cd7a"]]);export{se as default};

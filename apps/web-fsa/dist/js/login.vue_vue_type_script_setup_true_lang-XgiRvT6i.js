var ae=Object.defineProperty,ne=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var H=(i,n,o)=>n in i?ae(i,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[n]=o,X=(i,n)=>{for(var o in n||(n={}))re.call(n,o)&&H(i,o,n[o]);if(O)for(var o of O(n))le.call(n,o)&&H(i,o,n[o]);return i},Q=(i,n)=>ne(i,ie(n));var Z=(i,n,o)=>new Promise((r,f)=>{var c=p=>{try{l(o.next(p))}catch(w){f(w)}},e=p=>{try{l(o.throw(p))}catch(w){f(w)}},l=p=>p.done?r(p.value):Promise.resolve(p.value).then(c,e);l((o=o.apply(i,n)).next())});import{aJ as ue,aY as ce,q as fe,$ as u,aZ as K,G as de,H as z,a_ as me,a$ as pe,aL as he}from"./bootstrap-nS_r6Uzy.js";import{d as B,c as I,j as _,k as m,y as F,v as S,h as W,r as G,n as j,b as h,u as t,K as g,E as V,L as x,x as v,a1 as ee,a2 as ge,Q as oe,w as ye,a as be,ac as we,Y as te,q as ve,m as E,f as _e,l as R,ad as $e}from"../jse/index-index-BsdptGcH.js";import{C as ke,_ as Pe}from"./checkbox.vue_vue_type_script_setup_true_lang-BsbbvZXe.js";import{T as Le}from"./auth-title-syvjO5h0.js";import{a as Se,b as Te,M as Me,c as Re}from"./index-BVdTAobs.js";import{u as xe,a as se,b as Ee}from"./use-vben-form-qIoZL4uF.js";const Be=B({__name:"spine-text",props:{animationDuration:{default:2},animationIterationCount:{default:"infinite"}},setup(i){const n=I(()=>({animation:`shine ${i.animationDuration}s linear ${i.animationIterationCount}`}));return(o,r)=>(m(),_("div",{style:F(n.value),class:"vben-spine-text !bg-clip-text text-transparent"},[S(o.$slots,"default")],4))}}),Ce=B({__name:"slider-captcha-action",props:{actionStyle:{},isPassing:{type:Boolean},toLeft:{type:Boolean}},setup(i,{expose:n}){const o=i,r=W("actionRef"),f=G("0"),c=I(()=>{const{actionStyle:l}=o;return Q(X({},l),{left:f.value})}),e=I(()=>Number.parseInt(f.value)>10&&!o.isPassing);return n({getEl:()=>r.value,getStyle:()=>{var l;return(l=r==null?void 0:r.value)==null?void 0:l.style},setLeft:l=>{f.value=l}}),(l,p)=>(m(),_("div",{ref_key:"actionRef",ref:r,class:j([{"transition-width !left-0 duration-300":l.toLeft,"rounded-md":e.value},"bg-background dark:bg-accent absolute left-0 top-0 flex h-full cursor-move items-center justify-center px-3.5 shadow-md"]),style:F(c.value),name:"captcha-action"},[h(t(ue),{"is-passing":l.isPassing,class:"text-foreground/60 size-4"},{default:g(()=>[S(l.$slots,"icon",{},()=>[l.isPassing?(m(),V(t(ke),{key:1})):(m(),V(t(ce),{key:0}))])]),_:3},8,["is-passing"])],6))}}),De=B({__name:"slider-captcha-bar",props:{barStyle:{},toLeft:{type:Boolean}},setup(i,{expose:n}){const o=i,r=W("barRef"),f=G("0"),c=I(()=>{const{barStyle:e}=o;return Q(X({},e),{width:f.value})});return n({getEl:()=>r.value,setWidth:e=>{f.value=e}}),(e,l)=>(m(),_("div",{ref_key:"barRef",ref:r,class:j([e.toLeft&&"transition-width !w-0 duration-300","bg-success absolute h-full"]),style:F(c.value)},null,6))}}),We=B({__name:"slider-captcha-content",props:{contentStyle:{},isPassing:{type:Boolean},successText:{},text:{}},setup(i,{expose:n}){const o=i,r=W("contentRef"),f=I(()=>{const{contentStyle:c}=o;return X({},c)});return n({getEl:()=>r.value}),(c,e)=>(m(),_("div",{ref_key:"contentRef",ref:r,class:j([{[c.$style.success]:c.isPassing},"absolute top-0 flex size-full select-none items-center justify-center text-xs"]),style:F(f.value)},[S(c.$slots,"text",{},()=>[h(t(Be),{class:"flex h-full items-center"},{default:g(()=>[x(v(c.isPassing?c.successText:c.text),1)]),_:1})])],6))}}),Ve="_success_fwxn1_2",Ie={success:Ve},Ne={$style:Ie},qe=fe(We,[["__cssModules",Ne]]),Fe=B({__name:"index",props:ee({class:{},actionStyle:{default:()=>({})},barStyle:{default:()=>({})},contentStyle:{default:()=>({})},wrapperStyle:{default:()=>({})},isSlot:{type:Boolean,default:!1},successText:{default:""},text:{default:""}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:ee(["end","move","start","success"],["update:modelValue"]),setup(i,{expose:n,emit:o}){const r=i,f=o,c=ge(i,"modelValue"),e=oe({endTime:0,isMoving:!1,isPassing:!1,moveDistance:0,startTime:0,toLeft:!1});n({resume:A});const l=W("wrapperRef"),p=W("barRef"),w=W("contentRef"),$=W("actionRef");ye(()=>e.isPassing,s=>{if(s){const{endTime:y,startTime:b}=e,k=(y-b)/1e3;f("success",{isPassing:s,time:k.toFixed(1)}),c.value=s}}),be(()=>{e.isPassing=!!c.value});function N(s){return"pageX"in s?s.pageX:"touches"in s&&s.touches[0]?s.touches[0].pageX:0}function C(s){e.isPassing||$.value&&(f("start",s),e.moveDistance=N(s)-Number.parseInt($.value.getStyle().left.replace("px","")||"0",10),e.startTime=Date.now(),e.isMoving=!0)}function a(s){var P,L,D;const y=(L=(P=l.value)==null?void 0:P.offsetWidth)!=null?L:220,b=(D=s==null?void 0:s.offsetWidth)!=null?D:40,k=y-b-6;return{actionWidth:b,offset:k,wrapperWidth:y}}function d(s){const{isMoving:y,moveDistance:b}=e;if(y){const k=t($),P=t(p);if(!k||!P)return;const{actionWidth:L,offset:D,wrapperWidth:q}=a(k.getEl()),M=N(s)-b;f("move",{event:s,moveDistance:b,moveX:M}),M>0&&M<=D?(k.setLeft(`${M}px`),P.setWidth(`${M+L/2}px`)):M>D&&(k.setLeft(`${q-L}px`),P.setWidth(`${q-L/2}px`),r.isSlot||U())}}function T(s){const{isMoving:y,isPassing:b,moveDistance:k}=e;if(y&&!b){f("end",s);const P=$.value,L=t(p);if(!P||!L)return;const D=N(s)-k,{actionWidth:q,offset:M,wrapperWidth:Y}=a(P.getEl());D<M?r.isSlot?setTimeout(()=>{if(c.value){const J=t(w);J&&(J.getEl().style.width=`${Number.parseInt(L.getEl().style.width)}px`)}else A()},0):A():(P.setLeft(`${Y-q}px`),L.setWidth(`${Y-q/2}px`),U()),e.isMoving=!1}}function U(){if(r.isSlot){A();return}e.endTime=Date.now(),e.isPassing=!0,e.isMoving=!1}function A(){e.isMoving=!1,e.isPassing=!1,e.moveDistance=0,e.toLeft=!1,e.startTime=0,e.endTime=0;const s=t($),y=t(p),b=t(w);!s||!y||!b||(b.getEl().style.width="100%",e.toLeft=!0,we(()=>{e.toLeft=!1,s.setLeft("0"),y.setWidth("0")},300))}return(s,y)=>(m(),_("div",{ref_key:"wrapperRef",ref:l,class:j(t(ve)("border-border bg-background-deep relative flex h-10 w-full items-center overflow-hidden rounded-md border text-center",r.class)),style:F(s.wrapperStyle),onMouseleave:T,onMousemove:d,onMouseup:T,onTouchend:T,onTouchmove:d},[h(De,{ref_key:"barRef",ref:p,"bar-style":s.barStyle,"to-left":e.toLeft},null,8,["bar-style","to-left"]),h(qe,{ref_key:"contentRef",ref:w,"content-style":s.contentStyle,"is-passing":e.isPassing,"success-text":s.successText||t(u)("ui.captcha.sliderSuccessText"),text:s.text||t(u)("ui.captcha.sliderDefaultText")},te({_:2},[s.$slots.text?{name:"text",fn:g(()=>[S(s.$slots,"text",{isPassing:e.isPassing})]),key:"0"}:void 0]),1032,["content-style","is-passing","success-text","text"]),h(Ce,{ref_key:"actionRef",ref:$,"action-style":s.actionStyle,"is-passing":e.isPassing,"to-left":e.toLeft,onMousedown:C,onTouchstart:C},te({_:2},[s.$slots.actionIcon?{name:"icon",fn:g(()=>[S(s.$slots,"actionIcon",{isPassing:e.isPassing})]),key:"0"}:void 0]),1032,["action-style","is-passing","to-left"])],38))}}),je={class:"w-full sm:mx-auto md:max-w-md"},Ae={class:"mt-4 flex items-center justify-between"},Xe={class:"text-muted-foreground text-center text-xs uppercase"},Ke={class:"mt-4 flex flex-wrap justify-center"},Qe=B({name:"ThirdPartyLogin",__name:"third-party-login",setup(i){return(n,o)=>(m(),_("div",je,[E("div",Ae,[o[0]||(o[0]=E("span",{class:"border-input w-[35%] border-b dark:border-gray-600"},null,-1)),E("span",Xe,v(t(u)("authentication.thirdPartyLogin")),1),o[1]||(o[1]=E("span",{class:"border-input w-[35%] border-b dark:border-gray-600"},null,-1))]),E("div",Ke,[h(t(K),{class:"mb-3"},{default:g(()=>[h(t(Se))]),_:1}),h(t(K),{class:"mb-3"},{default:g(()=>[h(t(Te))]),_:1}),h(t(K),{class:"mb-3"},{default:g(()=>[h(t(Me))]),_:1}),h(t(K),{class:"mb-3"},{default:g(()=>[h(t(Re))]),_:1})])]))}}),ze=["onKeydown"],Ge={class:"text-muted-foreground"},Ue={key:0,class:"mb-6 flex justify-between"},Ye={class:"flex-center"},Je={key:1,class:"mb-2 mt-4 flex items-center justify-between"},Oe={key:0,class:"mt-3 text-center text-sm"},He=B({name:"AuthenticationLogin",__name:"login",props:{formSchema:{default:()=>[]},codeLoginPath:{default:"/auth/code-login"},forgetPasswordPath:{default:"/auth/forget-password"},loading:{type:Boolean,default:!1},qrCodeLoginPath:{default:"/auth/qrcode-login"},registerPath:{default:"/auth/register"},showCodeLogin:{type:Boolean,default:!0},showForgetPassword:{type:Boolean,default:!0},showQrcodeLogin:{type:Boolean,default:!0},showRegister:{type:Boolean,default:!0},showRememberMe:{type:Boolean,default:!0},showThirdPartyLogin:{type:Boolean,default:!0},subTitle:{default:""},title:{default:""},submitButtonText:{default:""}},emits:["submit"],setup(i,{expose:n,emit:o}){const r=i,f=o,[c,e]=xe(oe({commonConfig:{hideLabel:!0,hideRequiredMark:!0},schema:I(()=>r.formSchema),showDefaultActions:!1})),l=de(),p=`REMEMBER_ME_USERNAME_${location.hostname}`,w=localStorage.getItem(p)||"",$=G(!!w);function N(){return Z(this,null,function*(){const{valid:a}=yield e.validate(),d=yield e.getValues();a&&(localStorage.setItem(p,$.value?d==null?void 0:d.username:""),f("submit",d))})}function C(a){l.push(a)}return _e(()=>{w&&e.setFieldValue("username",w)}),n({getFormApi:()=>e}),(a,d)=>(m(),_("div",{onKeydown:me(pe(N,["prevent"]),["enter"])},[S(a.$slots,"title",{},()=>[h(Le,null,{desc:g(()=>[E("span",Ge,[S(a.$slots,"subTitle",{},()=>[x(v(a.subTitle||t(u)("authentication.loginSubtitle")),1)])])]),default:g(()=>[S(a.$slots,"title",{},()=>[x(v(a.title||`${t(u)("authentication.welcomeBack")} 👋🏻`),1)])]),_:3})]),h(t(c)),a.showRememberMe||a.showForgetPassword?(m(),_("div",Ue,[E("div",Ye,[a.showRememberMe?(m(),V(t(Pe),{key:0,checked:$.value,"onUpdate:checked":d[0]||(d[0]=T=>$.value=T),name:"rememberMe"},{default:g(()=>[x(v(t(u)("authentication.rememberMe")),1)]),_:1},8,["checked"])):R("",!0)]),a.showForgetPassword?(m(),_("span",{key:0,class:"vben-link text-sm font-normal",onClick:d[1]||(d[1]=T=>C(a.forgetPasswordPath))},v(t(u)("authentication.forgetPassword")),1)):R("",!0)])):R("",!0),h(t(z),{class:j([{"cursor-wait":a.loading},"w-full"]),loading:a.loading,"aria-label":"login",onClick:N},{default:g(()=>[x(v(a.submitButtonText||t(u)("common.login")),1)]),_:1},8,["class","loading"]),a.showCodeLogin||a.showQrcodeLogin?(m(),_("div",Je,[a.showCodeLogin?(m(),V(t(z),{key:0,class:"w-1/2",variant:"outline",onClick:d[2]||(d[2]=T=>C(a.codeLoginPath))},{default:g(()=>[x(v(t(u)("authentication.mobileLogin")),1)]),_:1})):R("",!0),a.showQrcodeLogin?(m(),V(t(z),{key:1,class:"ml-4 w-1/2",variant:"outline",onClick:d[3]||(d[3]=T=>C(a.qrCodeLoginPath))},{default:g(()=>[x(v(t(u)("authentication.qrcodeLogin")),1)]),_:1})):R("",!0)])):R("",!0),S(a.$slots,"third-party-login",{},()=>[a.showThirdPartyLogin?(m(),V(Qe,{key:0})):R("",!0)]),S(a.$slots,"to-register",{},()=>[a.showRegister?(m(),_("div",Oe,[x(v(t(u)("authentication.accountTip"))+" ",1),E("span",{class:"vben-link text-sm font-normal",onClick:d[4]||(d[4]=T=>C(a.registerPath))},v(t(u)("authentication.createAccount")),1)])):R("",!0)])],40,ze))}}),it=B({name:"Login",__name:"login",setup(i){const n=he(),o=I(()=>[{component:"VbenInput",componentProps:{placeholder:u("page.auth.phoneTip")},fieldName:"phone",label:u("page.auth.phone"),rules:se().min(1,{message:u("page.auth.phoneTip")})},{component:"VbenInputPassword",componentProps:{placeholder:u("authentication.password")},fieldName:"password",label:u("authentication.password"),rules:se().min(1,{message:u("authentication.passwordTip")})},{component:$e(Fe),fieldName:"captcha",rules:Ee().refine(r=>r,{message:u("authentication.verifyRequiredTip")})}]);return(r,f)=>(m(),V(t(He),{"form-schema":o.value,loading:t(n).loginLoading,"show-code-login":!1,"show-qrcode-login":!1,"show-third-party-login":!1,"show-register":!1,"show-remember-me":!1,"show-forget-password":!1,onSubmit:t(n).authLogin,title:t(u)("page.auth.loginTitle"),"sub-title":t(u)("page.auth.loginSubtitle")},null,8,["form-schema","loading","onSubmit","title","sub-title"]))}});export{it as _};
